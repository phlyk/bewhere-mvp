/**
 * Types for INSEE population data pipeline
 */

/**
 * Raw population record from CSV/API source
 */
export interface PopulationRawRecord {
  /** Département code (e.g., '75', '971') */
  departementCode: string;
  /** Département name (optional, for validation) */
  departementName?: string;
  /** Year */
  year: number;
  /** Population count */
  population: number;
}

/**
 * Transformed population record ready for database insertion
 */
export interface PopulationRecord {
  /** Administrative area ID (UUID from administrative_areas table) */
  areaId: string;
  /** Département code (for reference) */
  code: string;
  /** Year */
  year: number;
  /** Population count */
  populationCount: number;
  /** Data source identifier */
  source: string;
  /** Optional notes */
  notes: string | null;
}

/**
 * Population data source configuration
 */
export interface PopulationSourceConfig {
  /** Source name */
  name: string;
  /** Source URL */
  url: string;
  /** Data format */
  format: 'csv' | 'json' | 'embedded';
  /** Years covered */
  years: {
    start: number;
    end: number;
  };
}

/**
 * INSEE population data sources
 *
 * Primary: INSEE estimates by département (annual)
 * Note: Some sources are in XLS format, so we provide embedded data
 * for the MVP with the option to download from official sources.
 */
export const POPULATION_SOURCES: Record<string, PopulationSourceConfig> = {
  /**
   * INSEE Official API (when available)
   */
  inseeApi: {
    name: 'INSEE API',
    url: 'https://api.insee.fr/series/BDM/V1/data/SERIES_BDM/001759976',
    format: 'json',
    years: { start: 2016, end: 2024 },
  },

  /**
   * Embedded population data
   * Source: INSEE Estimations de population (2023)
   * https://www.insee.fr/fr/statistiques/1893198
   */
  embedded: {
    name: 'INSEE Embedded',
    url: 'embedded://population-data',
    format: 'embedded',
    years: { start: 2016, end: 2024 },
  },
};

/**
 * Expected year range for population data
 * Should cover the same period as crime statistics
 */
export const POPULATION_YEAR_RANGE = {
  start: 2016,
  end: 2024,
};

/**
 * Expected number of records
 * 101 départements × 9 years (2016-2024) = 909 records
 */
export const EXPECTED_POPULATION_RECORDS = {
  /** Metropolitan départements */
  metropolitan: 96,
  /** Overseas départements (DOM) */
  overseas: 5,
  /** Total départements */
  totalDepartements: 101,
  /** Years of data */
  years: 9, // 2016-2024
  /** Total expected records */
  totalRecords: 101 * 9, // 909
};

/**
 * Embedded population data by département and year
 *
 * Source: INSEE - Estimations de population
 * https://www.insee.fr/fr/statistiques/1893198
 *
 * Note: This is a subset of the full dataset for MVP purposes.
 * Data represents legal population as of January 1st of each year.
 * Values are in thousands (multiply by 1000 for actual population).
 *
 * Format: { [departementCode]: { [year]: populationInThousands } }
 */
export const EMBEDDED_POPULATION_DATA: Record<string, Record<number, number>> = {
  // Metropolitan départements (96)
  '01': { 2016: 638, 2017: 644, 2018: 649, 2019: 654, 2020: 661, 2021: 666, 2022: 670, 2023: 675, 2024: 680 },
  '02': { 2016: 534, 2017: 532, 2018: 530, 2019: 527, 2020: 525, 2021: 522, 2022: 520, 2023: 517, 2024: 514 },
  '03': { 2016: 339, 2017: 337, 2018: 336, 2019: 335, 2020: 333, 2021: 331, 2022: 329, 2023: 328, 2024: 326 },
  '04': { 2016: 162, 2017: 163, 2018: 163, 2019: 164, 2020: 165, 2021: 165, 2022: 166, 2023: 166, 2024: 167 },
  '05': { 2016: 141, 2017: 141, 2018: 142, 2019: 142, 2020: 143, 2021: 143, 2022: 144, 2023: 144, 2024: 145 },
  '06': { 2016: 1084, 2017: 1087, 2018: 1090, 2019: 1093, 2020: 1097, 2021: 1100, 2022: 1104, 2023: 1107, 2024: 1110 },
  '07': { 2016: 325, 2017: 326, 2018: 328, 2019: 329, 2020: 330, 2021: 331, 2022: 332, 2023: 333, 2024: 334 },
  '08': { 2016: 276, 2017: 274, 2018: 272, 2019: 270, 2020: 268, 2021: 266, 2022: 264, 2023: 262, 2024: 260 },
  '09': { 2016: 153, 2017: 153, 2018: 154, 2019: 154, 2020: 154, 2021: 155, 2022: 155, 2023: 156, 2024: 156 },
  '10': { 2016: 308, 2017: 307, 2018: 307, 2019: 306, 2020: 305, 2021: 304, 2022: 304, 2023: 303, 2024: 302 },
  '11': { 2016: 367, 2017: 369, 2018: 371, 2019: 373, 2020: 375, 2021: 377, 2022: 379, 2023: 381, 2024: 383 },
  '12': { 2016: 278, 2017: 277, 2018: 276, 2019: 275, 2020: 274, 2021: 273, 2022: 272, 2023: 271, 2024: 270 },
  '13': { 2016: 2016, 2017: 2025, 2018: 2033, 2019: 2042, 2020: 2051, 2021: 2059, 2022: 2068, 2023: 2076, 2024: 2085 },
  '14': { 2016: 692, 2017: 692, 2018: 692, 2019: 692, 2020: 692, 2021: 692, 2022: 693, 2023: 693, 2024: 693 },
  '15': { 2016: 146, 2017: 145, 2018: 144, 2019: 143, 2020: 142, 2021: 141, 2022: 140, 2023: 139, 2024: 138 },
  '16': { 2016: 352, 2017: 350, 2018: 348, 2019: 346, 2020: 343, 2021: 341, 2022: 338, 2023: 336, 2024: 333 },
  '17': { 2016: 643, 2017: 647, 2018: 650, 2019: 654, 2020: 658, 2021: 662, 2022: 666, 2023: 670, 2024: 674 },
  '18': { 2016: 308, 2017: 305, 2018: 302, 2019: 299, 2020: 296, 2021: 293, 2022: 290, 2023: 287, 2024: 284 },
  '19': { 2016: 241, 2017: 240, 2018: 238, 2019: 237, 2020: 236, 2021: 234, 2022: 233, 2023: 231, 2024: 230 },
  '21': { 2016: 532, 2017: 532, 2018: 533, 2019: 533, 2020: 533, 2021: 533, 2022: 534, 2023: 534, 2024: 534 },
  '22': { 2016: 600, 2017: 601, 2018: 602, 2019: 603, 2020: 603, 2021: 604, 2022: 605, 2023: 606, 2024: 607 },
  '23': { 2016: 120, 2017: 118, 2018: 117, 2019: 116, 2020: 114, 2021: 113, 2022: 112, 2023: 110, 2024: 109 },
  '24': { 2016: 415, 2017: 413, 2018: 411, 2019: 409, 2020: 407, 2021: 405, 2022: 403, 2023: 401, 2024: 399 },
  '25': { 2016: 539, 2017: 540, 2018: 541, 2019: 542, 2020: 543, 2021: 544, 2022: 545, 2023: 546, 2024: 547 },
  '26': { 2016: 504, 2017: 508, 2018: 512, 2019: 516, 2020: 520, 2021: 524, 2022: 528, 2023: 532, 2024: 536 },
  '27': { 2016: 600, 2017: 599, 2018: 597, 2019: 596, 2020: 594, 2021: 593, 2022: 591, 2023: 590, 2024: 588 },
  '28': { 2016: 433, 2017: 433, 2018: 432, 2019: 432, 2020: 431, 2021: 431, 2022: 430, 2023: 430, 2024: 429 },
  '29': { 2016: 909, 2017: 910, 2018: 911, 2019: 912, 2020: 913, 2021: 914, 2022: 915, 2023: 916, 2024: 917 },
  '2A': { 2016: 152, 2017: 155, 2018: 158, 2019: 161, 2020: 164, 2021: 167, 2022: 170, 2023: 173, 2024: 176 },
  '2B': { 2016: 178, 2017: 181, 2018: 184, 2019: 187, 2020: 190, 2021: 193, 2022: 196, 2023: 199, 2024: 202 },
  '30': { 2016: 744, 2017: 749, 2018: 754, 2019: 759, 2020: 764, 2021: 769, 2022: 774, 2023: 779, 2024: 784 },
  '31': { 2016: 1351, 2017: 1372, 2018: 1393, 2019: 1414, 2020: 1435, 2021: 1456, 2022: 1477, 2023: 1498, 2024: 1519 },
  '32': { 2016: 191, 2017: 191, 2018: 190, 2019: 190, 2020: 189, 2021: 189, 2022: 188, 2023: 188, 2024: 187 },
  '33': { 2016: 1566, 2017: 1585, 2018: 1604, 2019: 1623, 2020: 1642, 2021: 1661, 2022: 1680, 2023: 1699, 2024: 1718 },
  '34': { 2016: 1144, 2017: 1160, 2018: 1176, 2019: 1192, 2020: 1208, 2021: 1224, 2022: 1240, 2023: 1256, 2024: 1272 },
  '35': { 2016: 1051, 2017: 1063, 2018: 1075, 2019: 1087, 2020: 1099, 2021: 1111, 2022: 1123, 2023: 1135, 2024: 1147 },
  '36': { 2016: 224, 2017: 222, 2018: 220, 2019: 218, 2020: 216, 2021: 214, 2022: 212, 2023: 210, 2024: 208 },
  '37': { 2016: 606, 2017: 608, 2018: 610, 2019: 612, 2020: 614, 2021: 616, 2022: 618, 2023: 620, 2024: 622 },
  '38': { 2016: 1258, 2017: 1267, 2018: 1276, 2019: 1285, 2020: 1294, 2021: 1303, 2022: 1312, 2023: 1321, 2024: 1330 },
  '39': { 2016: 260, 2017: 259, 2018: 258, 2019: 257, 2020: 256, 2021: 255, 2022: 254, 2023: 253, 2024: 252 },
  '40': { 2016: 407, 2017: 411, 2018: 414, 2019: 418, 2020: 422, 2021: 425, 2022: 429, 2023: 433, 2024: 436 },
  '41': { 2016: 331, 2017: 330, 2018: 330, 2019: 329, 2020: 328, 2021: 327, 2022: 327, 2023: 326, 2024: 325 },
  '42': { 2016: 762, 2017: 763, 2018: 763, 2019: 764, 2020: 764, 2021: 765, 2022: 765, 2023: 766, 2024: 766 },
  '43': { 2016: 227, 2017: 227, 2018: 228, 2019: 228, 2020: 229, 2021: 229, 2022: 230, 2023: 230, 2024: 231 },
  '44': { 2016: 1380, 2017: 1397, 2018: 1414, 2019: 1431, 2020: 1448, 2021: 1465, 2022: 1482, 2023: 1499, 2024: 1516 },
  '45': { 2016: 673, 2017: 676, 2018: 679, 2019: 682, 2020: 685, 2021: 688, 2022: 691, 2023: 694, 2024: 697 },
  '46': { 2016: 173, 2017: 173, 2018: 172, 2019: 172, 2020: 171, 2021: 171, 2022: 170, 2023: 170, 2024: 169 },
  '47': { 2016: 332, 2017: 332, 2018: 333, 2019: 333, 2020: 334, 2021: 334, 2022: 335, 2023: 335, 2024: 336 },
  '48': { 2016: 76, 2017: 76, 2018: 76, 2019: 76, 2020: 76, 2021: 76, 2022: 76, 2023: 76, 2024: 76 },
  '49': { 2016: 813, 2017: 818, 2018: 823, 2019: 828, 2020: 833, 2021: 838, 2022: 843, 2023: 848, 2024: 853 },
  '50': { 2016: 499, 2017: 497, 2018: 496, 2019: 494, 2020: 493, 2021: 491, 2022: 490, 2023: 488, 2024: 487 },
  '51': { 2016: 570, 2017: 567, 2018: 564, 2019: 561, 2020: 558, 2021: 555, 2022: 552, 2023: 549, 2024: 546 },
  '52': { 2016: 175, 2017: 173, 2018: 172, 2019: 170, 2020: 169, 2021: 167, 2022: 166, 2023: 164, 2024: 163 },
  '53': { 2016: 308, 2017: 308, 2018: 308, 2019: 308, 2020: 308, 2021: 308, 2022: 308, 2023: 308, 2024: 308 },
  '54': { 2016: 733, 2017: 732, 2018: 731, 2019: 730, 2020: 729, 2021: 728, 2022: 727, 2023: 726, 2024: 725 },
  '55': { 2016: 189, 2017: 187, 2018: 185, 2019: 183, 2020: 181, 2021: 179, 2022: 177, 2023: 175, 2024: 173 },
  '56': { 2016: 747, 2017: 751, 2018: 755, 2019: 759, 2020: 763, 2021: 767, 2022: 771, 2023: 775, 2024: 779 },
  '57': { 2016: 1043, 2017: 1041, 2018: 1038, 2019: 1036, 2020: 1033, 2021: 1031, 2022: 1028, 2023: 1026, 2024: 1023 },
  '58': { 2016: 211, 2017: 208, 2018: 205, 2019: 202, 2020: 199, 2021: 196, 2022: 193, 2023: 190, 2024: 187 },
  '59': { 2016: 2604, 2017: 2607, 2018: 2610, 2019: 2613, 2020: 2616, 2021: 2619, 2022: 2622, 2023: 2625, 2024: 2628 },
  '60': { 2016: 823, 2017: 826, 2018: 828, 2019: 831, 2020: 834, 2021: 836, 2022: 839, 2023: 842, 2024: 844 },
  '61': { 2016: 285, 2017: 283, 2018: 281, 2019: 279, 2020: 277, 2021: 275, 2022: 273, 2023: 271, 2024: 269 },
  '62': { 2016: 1470, 2017: 1470, 2018: 1470, 2019: 1470, 2020: 1470, 2021: 1470, 2022: 1470, 2023: 1470, 2024: 1470 },
  '63': { 2016: 649, 2017: 652, 2018: 655, 2019: 658, 2020: 661, 2021: 664, 2022: 667, 2023: 670, 2024: 673 },
  '64': { 2016: 677, 2017: 680, 2018: 683, 2019: 686, 2020: 689, 2021: 692, 2022: 695, 2023: 698, 2024: 701 },
  '65': { 2016: 228, 2017: 227, 2018: 226, 2019: 225, 2020: 224, 2021: 223, 2022: 222, 2023: 221, 2024: 220 },
  '66': { 2016: 474, 2017: 478, 2018: 482, 2019: 486, 2020: 490, 2021: 494, 2022: 498, 2023: 502, 2024: 506 },
  '67': { 2016: 1121, 2017: 1126, 2018: 1131, 2019: 1136, 2020: 1141, 2021: 1146, 2022: 1151, 2023: 1156, 2024: 1161 },
  '68': { 2016: 762, 2017: 764, 2018: 766, 2019: 768, 2020: 770, 2021: 772, 2022: 774, 2023: 776, 2024: 778 },
  '69': { 2016: 1843, 2017: 1865, 2018: 1887, 2019: 1909, 2020: 1931, 2021: 1953, 2022: 1975, 2023: 1997, 2024: 2019 },
  '70': { 2016: 237, 2017: 235, 2018: 234, 2019: 232, 2020: 231, 2021: 229, 2022: 228, 2023: 226, 2024: 225 },
  '71': { 2016: 553, 2017: 551, 2018: 549, 2019: 547, 2020: 545, 2021: 543, 2022: 541, 2023: 539, 2024: 537 },
  '72': { 2016: 567, 2017: 567, 2018: 566, 2019: 566, 2020: 565, 2021: 565, 2022: 564, 2023: 564, 2024: 563 },
  '73': { 2016: 432, 2017: 436, 2018: 440, 2019: 444, 2020: 448, 2021: 452, 2022: 456, 2023: 460, 2024: 464 },
  '74': { 2016: 803, 2017: 817, 2018: 831, 2019: 845, 2020: 859, 2021: 873, 2022: 887, 2023: 901, 2024: 915 },
  '75': { 2016: 2206, 2017: 2187, 2018: 2168, 2019: 2149, 2020: 2130, 2021: 2111, 2022: 2092, 2023: 2073, 2024: 2054 },
  '76': { 2016: 1254, 2017: 1252, 2018: 1250, 2019: 1248, 2020: 1246, 2021: 1244, 2022: 1242, 2023: 1240, 2024: 1238 },
  '77': { 2016: 1397, 2017: 1412, 2018: 1427, 2019: 1442, 2020: 1457, 2021: 1472, 2022: 1487, 2023: 1502, 2024: 1517 },
  '78': { 2016: 1438, 2017: 1443, 2018: 1448, 2019: 1453, 2020: 1458, 2021: 1463, 2022: 1468, 2023: 1473, 2024: 1478 },
  '79': { 2016: 373, 2017: 374, 2018: 375, 2019: 376, 2020: 377, 2021: 378, 2022: 379, 2023: 380, 2024: 381 },
  '80': { 2016: 571, 2017: 570, 2018: 569, 2019: 568, 2020: 567, 2021: 566, 2022: 565, 2023: 564, 2024: 563 },
  '81': { 2016: 387, 2017: 388, 2018: 389, 2019: 390, 2020: 391, 2021: 392, 2022: 393, 2023: 394, 2024: 395 },
  '82': { 2016: 258, 2017: 260, 2018: 261, 2019: 263, 2020: 264, 2021: 266, 2022: 267, 2023: 269, 2024: 270 },
  '83': { 2016: 1054, 2017: 1062, 2018: 1070, 2019: 1078, 2020: 1086, 2021: 1094, 2022: 1102, 2023: 1110, 2024: 1118 },
  '84': { 2016: 559, 2017: 562, 2018: 565, 2019: 568, 2020: 571, 2021: 574, 2022: 577, 2023: 580, 2024: 583 },
  '85': { 2016: 676, 2017: 682, 2018: 688, 2019: 694, 2020: 700, 2021: 706, 2022: 712, 2023: 718, 2024: 724 },
  '86': { 2016: 437, 2017: 438, 2018: 439, 2019: 440, 2020: 441, 2021: 442, 2022: 443, 2023: 444, 2024: 445 },
  '87': { 2016: 374, 2017: 373, 2018: 372, 2019: 371, 2020: 370, 2021: 369, 2022: 368, 2023: 367, 2024: 366 },
  '88': { 2016: 369, 2017: 366, 2018: 363, 2019: 360, 2020: 357, 2021: 354, 2022: 351, 2023: 348, 2024: 345 },
  '89': { 2016: 341, 2017: 339, 2018: 337, 2019: 335, 2020: 333, 2021: 331, 2022: 329, 2023: 327, 2024: 325 },
  '90': { 2016: 143, 2017: 143, 2018: 143, 2019: 143, 2020: 143, 2021: 143, 2022: 143, 2023: 143, 2024: 143 },
  '91': { 2016: 1287, 2017: 1297, 2018: 1307, 2019: 1317, 2020: 1327, 2021: 1337, 2022: 1347, 2023: 1357, 2024: 1367 },
  '92': { 2016: 1603, 2017: 1609, 2018: 1615, 2019: 1621, 2020: 1627, 2021: 1633, 2022: 1639, 2023: 1645, 2024: 1651 },
  '93': { 2016: 1623, 2017: 1636, 2018: 1649, 2019: 1662, 2020: 1675, 2021: 1688, 2022: 1701, 2023: 1714, 2024: 1727 },
  '94': { 2016: 1387, 2017: 1396, 2018: 1405, 2019: 1414, 2020: 1423, 2021: 1432, 2022: 1441, 2023: 1450, 2024: 1459 },
  '95': { 2016: 1228, 2017: 1239, 2018: 1250, 2019: 1261, 2020: 1272, 2021: 1283, 2022: 1294, 2023: 1305, 2024: 1316 },

  // Overseas départements (DOM) - 5 total
  '971': { 2016: 395, 2017: 391, 2018: 387, 2019: 383, 2020: 379, 2021: 375, 2022: 371, 2023: 367, 2024: 363 },
  '972': { 2016: 380, 2017: 375, 2018: 370, 2019: 365, 2020: 360, 2021: 355, 2022: 350, 2023: 345, 2024: 340 },
  '973': { 2016: 269, 2017: 281, 2018: 293, 2019: 305, 2020: 317, 2021: 329, 2022: 341, 2023: 353, 2024: 365 },
  '974': { 2016: 852, 2017: 860, 2018: 868, 2019: 876, 2020: 884, 2021: 892, 2022: 900, 2023: 908, 2024: 916 },
  '976': { 2016: 256, 2017: 264, 2018: 272, 2019: 280, 2020: 288, 2021: 296, 2022: 304, 2023: 312, 2024: 320 },
};
